(function(){angular.module("parse",[]).service("Parse",["$window",function(){return Parse.initialize("sXYBJKAzNLajxXs0SqkpjDmPKSY8eES5c4xOH275","nuLMfhWkmuKIbOYj00rzzUs7A9T4uYWMC5u45c99"),Parse}]),angular.module("voyageVoyage",["ngRoute","ngResource","underscore","ngFileUpload","ngMessages","toastr","parse","ui.bootstrap","ui.router"])}).call(this),function(){angular.module("voyageVoyage").directive("vvSelect",["_",function(e){return{restrict:"E",templateUrl:"app/shared/vv_select/select.html",require:"?ngModel",scope:{model:"=ngModel",items:"=",displayField:"@",valueField:"@",emptyText:"@"},link:function(t,r,n,o){var a,s,i;return t.current=t.emptyText||"Choose",i=!!t.valueField,i||o.$parsers.push(function(e){return t.items[e]}),a=angular.element(r[0].firstChild),a.on("click",function(){return a.toggleClass("active")}),t.$watch("model",function(e){return e?s(e):t.current=t.emptyText||"Choose"}),s=function(r){var n;if(i){if(n=e.find(t.items,function(e){return e[t.valueField]===r}))return t.current=n[t.displayField]}else{if(r.hasOwnProperty(t.displayField))return t.current=r[t.displayField];if(n=e.find(t.items,function(e){return e.objectId===r.objectId}))return t.current=n[t.displayField]}},t.reset=function(){return o.$setViewValue(null),t.current=t.emptyText},t.change=function(e,r){return t.$evalAsync(function(){var n;return n=i?e[t.valueField]:r,o.$setViewValue(n),t.current=e[t.displayField]})}}}}])}.call(this),function(){angular.module("voyageVoyage").directive("vvToursFilter",function(){return{restrict:"E",templateUrl:"app/shared/tours_filter/tours.filter.html",transclude:!0,scope:{places:"=",countries:"=",selectedCountry:"=",selectedPlace:"=",selectedStars:"=",filterChangedCallback:"&filterChanged"},controller:["$scope",function(e){this.reset=function(){return e.reset()}}],link:function(e,t,r){return e.stars=[{val:2},{val:3},{val:4},{val:5}],e.$watch("places.length",function(t){return t>0?e.placesFiltered=e.places:void 0}),e.onFilterChanged=function(){return e.placesFiltered=e.places.filter(function(t){return e.selectedCountry?t.countryId===e.selectedCountry.objectId:!0}),e.filterChangedCallback()},e.reset=function(){return e.selectedStars=null,e.selectedCountry=null,e.selectedPlace=null,e.placesFiltered=e.places},e.$on("filter.country",function(t,r){return e.filterChangedCallback(),e.selectedCountry={objectId:r.id}}),e.$on("filter.place",function(t,r){return e.filterChangedCallback(),e.selectedPlace={objectId:r.id}})}}}),angular.module("voyageVoyage").directive("vvFilterReset",function(){return{restrict:"A",require:"^vvToursFilter",link:function(e,t,r,n){return t.on("click",function(){return e.$apply(function(){return n.reset()})})}}}),angular.module("voyageVoyage").directive("vvTourLinkFilter",["$rootScope",function(e){return{restrict:"E",template:"<span class='label label-success' style='cursor: pointer;'>{{ text }}</span>",scope:{id:"@",text:"@",type:"@"},link:function(t,r,n){return r.on("click",function(){return t.$apply(function(){return e.$broadcast("filter."+t.type,{id:t.id})})})}}}])}.call(this),function(){angular.module("voyageVoyage").directive("vvTourImageFlipper",function(){return{restrict:"E",template:"<div class='tour-images'><img height='130' width='230' src='http://placehold.it/230x130?text=No+image' ng-show='images.length == 0'><div class='image' ng-transclude></div></div>",transclude:!0,scope:{},controller:["$scope","_",function(e,t){e.images=[],this.addImage=function(t){return 0===e.images.length&&(t.current=!0),e.images.push(t)},this.next=function(){return e.next()}}],link:function(e,t,r){return e.next=function(){var t;return t=_.findIndex(e.images,function(e){return e.current===!0}),e.images.forEach(function(e){return e.current=!1}),t+1===e.images.length?e.images[0].current=!0:e.images[t+1].current=!0}}}}),angular.module("voyageVoyage").directive("vvTourImage",function(){return{restrict:"E",require:"^vvTourImageFlipper",template:"<img alt='' height='130' width='230' ng-click='onClick()' ng-src='{{ image.url }}' ng-show='image.current == true'>",scope:{imageUrl:"@"},link:function(e,t,r,n){return e.image={url:e.imageUrl},n.addImage(e.image),e.onClick=function(){return n.next()}}}})}.call(this),function(){angular.module("voyageVoyage").directive("vvStars",["_",function(e){return{restrict:"E",templateUrl:"app/shared/stars/stars.html",scope:{stars:"@"},link:function(e,t,r){return e.times=function(e){var t;return function(){t=[];for(var r=1;e>=1?e>=r:r>=e;e>=1?r++:r--)t.push(r);return t}.apply(this)}}}}])}.call(this),function(){angular.module("voyageVoyage").directive("vvStarRating",["_",function(e){return{restrict:"E",require:"?ngModel",templateUrl:"app/shared/star_rating/star.rating.html",scope:{model:"=ngModel"},link:function(e,t,r,n){return e.times=function(e){var t;return function(){t=[];for(var r=1;e>=1?e>=r:r>=e;e>=1?r++:r--)t.push(r);return t}.apply(this)},e.$watch("model",function(t){return e.stars=t?t.val:0}),n.$parsers.push(function(e){return e>0?{val:e}:null}),e.reset=function(){return n.$setViewValue(0),e.stars=0},e.setStar=function(e){return n.$setViewValue(e)}}}}])}.call(this),function(){angular.module("voyageVoyage").service("TourRepository",["$http","$log","$q","Entity","_",function(e,t,r,n,o){var a;return a={},a.tours=[],a.baseUrl="https://api.parse.com/1/classes/",a.count=function(){var t;return t=e.get(a.baseUrl+"tour?count=1&limit=0")},a.all=function(o){var s,i;return 0===a.tours.length||o?(i=e.get(a.baseUrl+"tour").then(function(e){for(;a.tours.length>0;)a.tours.pop();return e.data.results.forEach(function(e){return a.tours.push(n.fromJSON(e))}),a.tours})["catch"](function(e){return t.error(e)}),a.tours.$promise=i):(s=r.defer(),s.resolve(a.tours),a.tours.$promise=s.promise),a.tours},a.getById=function(s,i){var l,u,c;return u=null,0===a.tours.length||!o.find(a.tours,function(e){return e.objectId===s})||i?(i&&(u=o.findIndex(a.tours,function(e){return e.objectId===s})),(-1===u||null===u)&&(u=a.tours.push({})-1),c=e.get(a.baseUrl+"tour/"+s).then(function(e){return angular.extend(a.tours[u],n.fromJSON(e.data)),a.tours[u]})["catch"](function(e){return t.error(e)}),a.tours[u].$promise=c):(l=r.defer(),u=o.findIndex(a.tours,function(e){return e.objectId===s}),l.resolve(a.tours[u]),a.tours[u].$promise=l.promise),a.tours[u]},a.save=function(r){var n;return n=null,n=r.objectId?e.put(a.baseUrl+"tour/"+r.objectId,r):e.post(a.baseUrl+"tour",r).then(function(e){return r.objectId=e.data.objectId,a.tours.push(r)})["catch"](function(e){return t.error(e)})},a.addImage=function(t,r,n){var o;return o={fileName:{__type:"File",name:r,url:n}},e.post(a.baseUrl+"tour_image",o).then(function(r){var o,s;return s=r.data.objectId,o={pics:{__op:"Add",objects:[n]}},e.put(a.baseUrl+"tour/"+t.objectId,o).then(function(e){return t.pics=e.data.pics})})},a.remove=function(t){var r;return r=o.findIndex(a.tours,function(e){return t.objectId===e.objectId}),e["delete"](a.baseUrl+"tour/"+t.objectId).then(function(e){return a.tours.splice(r,1)})},a}])}.call(this),function(){angular.module("voyageVoyage").service("PlaceRepository",["$http","$log","$q","Entity","_",function(e,t,r,n,o){var a;return a={},a.places=[],a.baseUrl="https://api.parse.com/1/classes/",a.count=function(){var t;return t=e.get(a.baseUrl+"place?count=1&limit=0")},a.all=function(o){var s,i;return 0===a.places.length||o?(i=e.get(a.baseUrl+"place").then(function(e){for(;a.places.length>0;)a.places.pop();return e.data.results.forEach(function(e){return a.places.push(n.fromJSON(e))}),a.places})["catch"](function(e){return t.error(e)}),a.places.$promise=i):(s=r.defer(),s.resolve(a.places),a.places.$promise=s.promise),a.places},a.getById=function(s,i){var l,u,c;return u=null,0===a.places.length||!o.find(a.places,function(e){return e.objectId===s})||i?(i&&(u=o.findIndex(a.places,function(e){return e.objectId===s})),(-1===u||null===u)&&(u=a.places.push({})-1),c=e.get(a.baseUrl+"place/"+s).then(function(e){return angular.extend(a.places[u],n.fromJSON(e.data)),a.places[u]})["catch"](function(e){return t.error(e)}),a.places[u].$promise=c):(l=r.defer(),u=o.findIndex(a.places,function(e){return e.objectId===s}),l.resolve(a.places[u]),a.places[u].$promise=l.promise),a.places[u]},a.save=function(r){var n;return n=null,n=r.objectId?e.put(a.baseUrl+"place/"+r.objectId,r):e.post(a.baseUrl+"place",r).then(function(e){return r.objectId=e.data.objectId,a.places.push(r)})["catch"](function(e){return t.error(e)})},a.remove=function(t){var r;return r=o.findIndex(a.places,function(e){return t.objectId===e.objectId}),e["delete"](a.baseUrl+"place/"+t.objectId).then(function(e){return a.places.splice(r,1)})},a}])}.call(this),function(){angular.module("voyageVoyage").service("HotelRepository",["$http","$log","$q","Entity","_",function(e,t,r,n,o){var a;return a={},a.hotels=[],a.baseUrl="https://api.parse.com/1/classes/",a.count=function(){var t;return t=e.get(a.baseUrl+"hotel?count=1&limit=0")},a.all=function(o){var s,i;return 0===a.hotels.length||o?(i=e.get(a.baseUrl+"hotel").then(function(e){for(;a.hotels.length>0;)a.hotels.pop();return e.data.results.forEach(function(e){return a.hotels.push(n.fromJSON(e))}),a.hotels})["catch"](function(e){return t.error(e)}),a.hotels.$promise=i):(s=r.defer(),s.resolve(a.hotels),a.hotels.$promise=s.promise),a.hotels},a.getById=function(s,i){var l,u,c;return u=null,0===a.hotels.length||!o.find(a.hotels,function(e){return e.objectId===s})||i?(i&&(u=o.findIndex(a.hotels,function(e){return e.objectId===s})),(-1===u||null===u)&&(u=a.hotels.push({})-1),c=e.get(a.baseUrl+"hotel/"+s).then(function(e){return angular.extend(a.hotels[u],n.fromJSON(e.data)),a.hotels[u]})["catch"](function(e){return t.error(e)}),a.hotels[u].$promise=c):(l=r.defer(),u=o.findIndex(a.hotels,function(e){return e.objectId===s}),l.resolve(a.hotels[u]),a.hotels[u].$promise=l.promise),a.hotels[u]},a.save=function(r){var n;return n=null,n=r.objectId?e.put(a.baseUrl+"hotel/"+r.objectId,r):e.post(a.baseUrl+"hotel",r).then(function(e){return r.objectId=e.data.objectId,a.hotels.push(r)})["catch"](function(e){return t.error(e)})},a.remove=function(t){var r;return r=o.findIndex(a.hotels,function(e){return t.objectId===e.objectId}),e["delete"](a.baseUrl+"hotel/"+t.objectId).then(function(e){return a.hotels.splice(r,1)})},a}])}.call(this),function(){angular.module("voyageVoyage").service("CountryRepository",["$http","$log","$q","Entity","_",function(e,t,r,n,o){var a;return a={},a.countries=[],a.baseUrl="https://api.parse.com/1/classes/",a.count=function(){var t;return t=e.get(a.baseUrl+"country?count=1&limit=0")},a.all=function(o){var s,i;return 0===a.countries.length||o?(i=e.get(a.baseUrl+"country").then(function(e){for(;a.countries.length>0;)a.countries.pop();return e.data.results.forEach(function(e){return a.countries.push(n.fromJSON(e))}),a.countries})["catch"](function(e){return t.error(e)}),a.countries.$promise=i):(s=r.defer(),s.resolve(a.countries),a.countries.$promise=s.promise),a.countries},a.getById=function(s,i){var l,u,c;return u=null,0===a.countries.length||!o.find(a.countries,function(e){return e.objectId===s})||i?(i&&(u=o.findIndex(a.countries,function(e){return e.objectId===s})),(-1===u||null===u)&&(u=a.countries.push({})-1),c=e.get(a.baseUrl+"country/"+s).then(function(e){return angular.extend(a.countries[u],n.fromJSON(e.data)),a.countries[u]})["catch"](function(e){return t.error(e)}),a.countries[u].$promise=c):(l=r.defer(),u=o.findIndex(a.countries,function(e){return e.objectId===s}),l.resolve(a.countries[u]),a.countries[u].$promise=l.promise),a.countries[u]},a.save=function(r){var n;return n=null,n=r.objectId?e.put(a.baseUrl+"country/"+r.objectId,r):e.post(a.baseUrl+"country",r).then(function(e){return r.objectId=e.data.objectId,a.countries.push(r)})["catch"](function(e){return t.error(e)})},a.remove=function(t){var r;return r=o.findIndex(a.countries,function(e){return t.objectId===e.objectId}),e["delete"](a.baseUrl+"country/"+t.objectId).then(function(e){return a.countries.splice(r,1)})},a}])}.call(this),function(){angular.module("voyageVoyage").directive("vvPager",function(){return{restrict:"E",templateUrl:"app/shared/pager/pager.html",scope:{currentPage:"=",pageSize:"@",totalItems:"@",pageChangedCallback:"&pageChanged"},link:function(e,t,r){return e.$watch("totalItems",function(){var t;return e.totalPages=Math.ceil(e.totalItems/e.pageSize),e.pages=function(){t=[];for(var r=1,n=e.totalPages;n>=1?n>=r:r>=n;n>=1?r++:r--)t.push(r);return t}.apply(this)}),e.setPage=function(t){return e.currentPage=t,e.pageChangedCallback({page:t})},e.pageForward=function(){return e.currentPage!==e.pages.length&&++e.currentPage,e.pageChangedCallback({page:e.currentPage})},e.pageBackward=function(){return 1!==e.currentPage&&--e.currentPage,e.pageChangedCallback({page:e.currentPage})}}}})}.call(this),function(){angular.module("voyageVoyage").directive("vvTourTeaser",function(){return{restrict:"E",templateUrl:"app/shared/new_tour_teaser/tour.teaser.html",scope:{},link:function(e,t,r){return e.$on("tour.new",function(t,r){return e.$apply(function(){return e.tour=r.tour})})}}})}.call(this),function(){angular.module("voyageVoyage").controller("PlacesController",["$scope","$q","PlaceRepository","CountryRepository","SimpleStateFactory","Entity",function(e,t,r,n,o,a){var s;return e.setState=function(t,r,n){return e.state=new o("place",t,n,r)},s={places:r.all().$promise,countries:n.all().$promise},t.all(s).then(function(t){return e.places=a.fromArray(t.places),e.countries=t.countries,e.setState("browse")}),e.add=function(){return r.save(e.state.place),e.push(e.state.place),e.setState("browse")},e.update=function(){return r.save(e.state.place).then(function(t){return console.log(t),e.setState("browse")})},e.cancelEdit=function(){return e.place.rejectChanges(),e.setState("browse")},e.remove=function(t){var n;return confirm("Удалить?")?(n=e.places[t],r.remove(n),e.places.splice(t,1)):void 0},e.getCountryById=function(t){var r;return r=_.find(e.countries,function(e){return e.objectId===t}),r.name}}])}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)r.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},r={}.hasOwnProperty;angular.module("voyageVoyage").factory("TourStateFactory",["Entity",function(r){var n,o,a,s,i;return n=function(){function e(){this.tour=null}return e.prototype.newFormShown=function(){return!1},e.prototype.listShown=function(){return!1},e.prototype.newButShown=function(){return!1},e.prototype.tour=null,e.prototype.editIndex=null,e.prototype.canCancel=function(){return!0},e}(),s=function(n){function o(){this.canCancel=e(this.canCancel,this),this.tour=new r}return t(o,n),o.prototype.newFormShown=function(){return!0},o.prototype.canCancel=function(){return this.tour.isEmpty()},o}(n),a=function(e){function r(e,t){this.tour=e,this.editIndex=t,this.tour.keepCopy()}return t(r,e),r.prototype.listShown=function(){return!0},r.prototype.canCancel=function(){return!this.tour.hasChanges()},r}(n),o=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.listShown=function(){return!0},r.prototype.newButShown=function(){return!0},r}(n),i=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.listShown=function(){return!0},r}(n),function(e,t,r){var n;return n=function(){switch(e){case"browse":return new o;case"new":return new s;case"inlineEdit":return new a(t,r)}}()}}])}.call(this),function(){angular.module("voyageVoyage").controller("AdminToursController",["$scope","$q","ImageUploadService","TourStateFactory","FakerFactory","Entity","TourRepository","HotelRepository","CountryRepository","PlaceRepository","toastr","_",function(e,t,r,n,o,a,s,i,l,u,c,d){var p,m,g;return m="Есть несохраненные изменения. Продолжить?",p="Удалить тур?",g={tours:s.all().$promise,places:u.all().$promise,countries:l.all().$promise,hotels:i.all().$promise},t.all(g).then(function(t){return e.tours=t.tours,e.countries=t.countries,e.places=t.places,e.hotels=t.hotels})["catch"](function(e){return alert(e)}),e.setState=function(t,r,o){return e.state=new n(t,r,o),e.tour=e.state.tour},e.setState("browse"),e.add=function(){return s.save(e.tour).then(function(){return c.success("Tour saved"),e.image?e.upload(e.image,e.tour).then(function(t){return s.save(e.tour),c.success("Image attached"),e.setState("browse")}):e.setState("browse")})},e.update=function(){return e.tour.commitChanges(),s.save(e.tour).then(function(){return c.success("Saved successfully")}),e.setState("browse")},e.cancel=function(){return e.state.canCancel()||confirm(m)?(e.tour.rejectChanges(),e.setState("browse")):void 0},e.remove=function(e){return confirm(p)?s.remove(e).then(function(){return c.success("Removed successfully")}):void 0},e.upload=function(t){return r.uploadImage(t,e.tour).then(function(t){return s.addImage(e.tour,t.data.name,t.data.url).then(function(){return c.success("Ok")})})},e.seedDb=function(){var t,r,n,s;return t=a.fromArray(o.countries),angular.forEach(t,function(e){return PersistenceService.saveResource("country",e)}),n=a.fromArray(o.places(e.countries)),angular.forEach(n,function(e){return PersistenceService.saveResource("place",e)}),r=a.fromArray(o.hotels),angular.forEach(r,function(e){return PersistenceService.saveResource("hotel",e)}),s=a.fromArray(o.tours(20,{countries:e.countries,places:e.places,hotels:e.hotels})),angular.forEach(s,function(e){return PersistenceService.saveResource("tour",e)}),alert("Seed finished")},e.getCountryById=function(t){var r;return r=d.find(e.countries,function(e){return e.objectId===t}),d.result(r,"name","n/a")},e.getPlaceById=function(t){var r;return r=d.find(e.places,function(e){return e.objectId===t}),d.result(r,"name","n/a")},e.getHotelById=function(t){var r;return r=d.find(e.hotels,function(e){return e.objectId===t})}}])}.call(this),function(){angular.module("voyageVoyage").controller("CountriesController",["$scope","PersistenceService","Entity","SimpleStateFactory","CRUDService","ImageUploadService",function(e,t,r,n,o,a){return e.file=null,e.setState=function(t,r,o){return e.state=new n("country",t,o,r)},t.loadResource("country").$promise.then(function(t){return e.countries=r.fromArray(t),e.setState("browse")}),e.add=function(){return o.add("country",e.state.country,e.countries,e.setState)},e.update=function(){return o.update("country",e.state.country,e.setState)},e.cancelEdit=function(){return o.cancelEdit(e.state.country,e.setState)},e.remove=function(t){return confirm("Удалить?")?o.remove("country",t,e.countries):void 0},e.upload=function(t){return a.uploadImage(t,e.state.country)}}])}.call(this),function(){angular.module("voyageVoyage").controller("HotelsController",["$scope","PersistenceService","Entity","SimpleStateFactory","CRUDService",function(e,t,r,n,o){return t.loadResource("hotel").$promise.then(function(t){return e.hotels=r.fromArray(t)}),e.setState=function(t,r,o){return e.state=new n("hotel",t,o,r)},e.state=e.setState("browse"),e.add=function(){return o.add("hotel",e.state.hotel,e.hotels,e.setState)},e.update=function(){return o.update("hotel",e.state.hotel,e.setState)},e.cancelEdit=function(){return o.cancelEdit(e.state.hotel,e.setState)},e.remove=function(t){return confirm("Удалить?")?o.remove("hotel",t,e.countries):void 0}}])}.call(this),function(){angular.module("voyageVoyage").controller("SignUpController",["$scope","$routeParams","Parse",function(e,t,r){return e.signup=function(){var t;return t=new r.User,t.set("username",e.username),t.set("password",e.password),t.signUp(null,{success:function(e){return console.log("Ok")},error:function(e,t){return console.log(t)}})}}])}.call(this),function(){angular.module("voyageVoyage").controller("SignInController",["$scope","$routeParams","$location","$window","Parse","$state",function(e,t,r,n,o,a){return e.name="some name",e.login=function(){return console.log("start"),o.User.logIn(e.username,e.password,{success:function(t){return console.log("Logged in"),n.location="/",e.apply()},error:function(e,t){return console.log(t)}})},e.current=function(){return o.User.current()},e.userName=function(){return o.User.current().getUsername()},e.logOut=function(){return o.User.logOut(),a.go("home"),e.apply()}}])}.call(this),function(){angular.module("voyageVoyage").controller("ToursController",["$scope","TourRepository","PlaceRepository","CountryRepository","HotelRepository","Entity","_","ToursFilterService","toastr",function(e,t,r,n,o,a,s,i,l){return e.itemsOnPage=5,e.setPage=function(t){return e.currentPage=t,e.pageBeginIndex=e.itemsOnPage*(t-1)},t.all().$promise.then(function(){return e.tours=t.tours,e.countries=n.all(),e.hotels=o.all(),e.places=r.all(),e.promos=s.sample(t.tours,4),console.log(e.promos),e.setPage(1)}),e.countryFilter=function(t){return i.countryFilter(t,e.selectedCountry)},e.placeFilter=function(t){return i.placeFilter(t,e.selectedPlace)},e.starsFilter=function(t){return i.starsFilter(t,e.hotels,e.selectedStars)},e.filterChanged=function(){return e.pageBeginIndex=0,e.currentPage=1},e.getCountryById=function(t){var r;return r=s.find(e.countries,function(e){return e.objectId===t}),s.result(r,"name","n/a")},e.getPlaceById=function(t){var r;return r=s.find(e.places,function(e){return e.objectId===t}),s.result(r,"name","n/a")},e.getHotelById=function(t){var r;return r=s.find(e.hotels,function(e){return e.objectId===t})}}])}.call(this),function(){angular.module("voyageVoyage").controller("TourController",["$scope","$stateParams","TourRepository","PlaceRepository","CountryRepository","HotelRepository",function(e,t,r,n,o,a){return r.getById(t.id).$promise.then(function(t){return e.tour=t,e.country=o.getById(t.countryId),e.hotel=a.getById(t.hotelId),e.place=n.getById(t.placeId)})}])}.call(this),function(){angular.module("voyageVoyage").service("ToursFilterService",["_",function(e){return{countryFilter:function(e,t){return t?e.countryId===t.objectId:!0},placeFilter:function(e,t){return t?e.placeId===t.objectId:!0},starsFilter:function(t,r,n){var o;return n?(o=e.find(r,function(e){return e.objectId===t.hotelId}),o.stars===n.val):!0}}}])}.call(this),function(){var e=function(e,r){function n(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("voyageVoyage").factory("SimpleStateFactory",["Entity",function(t){var r,n,o,a;return r=function(){function e(e){this[e]=null}return e.prototype.newButShown=function(){return!1},e.prototype.newButDisabled=function(){return!1},e.prototype.newFormShown=function(){return!1},e.prototype.editRemoveShown=function(){return!1},e.prototype.editIndex=null,e}(),n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.newButShown=function(){return!0},r.prototype.editRemoveShown=function(){return!0},r}(r),a=function(r){function n(e){this[e]=new t}return e(n,r),n.prototype.newFormShown=function(){return!0},n}(r),o=function(t){function r(e,t,r){this.editIndex=r,this[e]=t,this[e].keepCopy()}return e(r,t),r.prototype.newButDisabled=function(){return!0},r.prototype.newButShown=function(){return!0},r}(r),function(e,t,r,s){var i;return i=function(){switch(t){case"browse":return new n(e);case"add":return new a(e);case"edit":return new o(e,r,s)}}()}}])}.call(this),function(){angular.module("voyageVoyage").factory("ResourceFactory",["$resource",function(e){return function(t){var r;return r=e("https://api.parse.com/1/classes/"+t+"/:objectId",{objectId:"@objectId"},{query:{isArray:!0,transformResponse:function(e,t){return angular.fromJson(e).results},cache:!0},update:{method:"PUT"},getById:{method:"GET",isArray:!1}})}}])}.call(this),function(){angular.module("voyageVoyage").service("PersistenceService",["$resource","$q","ResourceFactory","$log",function(e,t,r,n){return{loadResourceById:function(e,t){return r(e).getById({objectId:t})},loadResource:function(e){return r(e).query()},saveResource:function(e,t){var o,a;return a=r(e),o=new a(t),t.objectId?o.$update().then(function(e){return t.commitChanges(),e})["catch"](function(e){return n.error(e),alert("Error!")}):o.$save().then(function(e){return t.objectId=e.objectId,e})["catch"](function(e){return n.error(e),alert("Error!")})},removeResource:function(e,t){var o,a;return a=r(e),o=new a({objectId:t.objectId}),o.$remove()["catch"](function(e){return n.error(e),alert("Error!")})}}}])}.call(this),function(){angular.module("voyageVoyage").factory("NewTourNotification",["$rootScope","TourRepository",function(e,t){var r;return r=this,r.init=function(){var r;return r=function(){var r;return r=Math.floor(1e4*Math.random()),setTimeout(function(){var r,n,o,a;return t.tours.length>0?(o=t.tours.length,r=Math.floor(Math.random()*o),n=t.tours[r],a={tour:{title:n.title,url:"/tour/"+n.objectId,price:n.price}},e.$broadcast("tour.new",a)):void 0},r)},setInterval(r,1e4)},r}])}.call(this),function(){angular.module("voyageVoyage").service("ImageUploadService",["Upload",function(e){return{uploadImage:function(t,r){var n;return n=e.http({url:"https://api.parse.com/1/files/pic.jpg",headers:{"Content-Type":"image/jpeg"},data:t}),n.then(function(e){return r.image={__type:"File",name:e.data.name,url:e.data.url},{name:e.data.url,url:e.data.url}})["catch"](function(e){return alert("Error!"),console.log(e)}),n}}}])}.call(this),function(){angular.module("voyageVoyage").filter("cutWords",function(){return function(e,t){var r,n;return r=new RegExp("^(\\S+[ ,.:;-\\s]+){1,"+t+"}","g"),n=r.exec(e),n[0].replace(/[- .,:;]+$/,"")}})}.call(this),function(){angular.module("voyageVoyage").factory("FakerFactory",function(){var e,t,r,n,o,a,s,i;return e=function(){this.country="Аргентина,Бразилия,Франция,Чехия,Корея,Япония,Швейцария,Колумбия,Ботсвана,Германия",this.adjective="Чарующая,Невероятная,Пугающая,Искрящаяся,Обычная,Скучная,Веселая,Зимняя,Летняя",this.place="beach,mountains,trekking,city",this.duration="3,5,7,10,14,21",this.hotel="Four Seasons,Hyatt,Radisson,Kempinski,Marriot,Mandarin Oriental,Hilton",this.star="2,3,4,5",this.text=["The LORD is my shepherd; I shall not want. He makes me lie down in green pastures. He leads me beside still waters. He restores my soul. He leads me in paths of righteousness for his name’s sake. Even though I walk through the valley of the shadow of death, I will fear no evil, for you are with me; your rod and your staff, they comfort me. You prepare a table before me in the presence of my enemies; you anoint my head with oil; my cup overflows. Surelyd goodness and mercye shall follow me all the days of my life, and I shall dwellf in the house of the LORD forever.","Каледонская складчатость просветляет холодный рельеф. Нижнее течение непосредственно применяет бамбук. Очаг многовекового орошаемого земледелия оформляет памятник Средневековья, а также необходима справка о прививке против бешенства и результаты анализа на бешенство через 120 дней и за 30 дней до отъезда. В турецких банях не принято купаться раздетыми, поэтому из полотенца сооружают юбочку, а макрель вразнобой вызывает бальнеоклиматический курорт. Пейзажный парк берёт туристический коралловый риф. Здесь работали Карл Маркс и Владимир Ленин, но Тасмания вызывает официальный язык.","Тюлень теоретически возможен. Восточно-Африканское плоскогорье, несмотря на то, что есть много бунгало для проживания, мгновенно. Субэкваториальный климат, несмотря на внешние воздействия, изменяем.","Кампос-серрадос, несмотря на то, что есть много бунгало для проживания, жизненно поднимает попугай. Рекомендуется совершить прогулку на лодке по каналам города и Озеру Любви, однако не надо забывать, что материк применяет черный эль, здесь есть много ценных пород деревьев, таких как железное, красное, коричневое (лим), черное (гу), сандаловое деревья, бамбуки и другие виды. Волна пространственно связывает туристический ледостав.","Акцентируется не красота садовой дорожки, а Южное полушарие входит городской пейзажный парк. Бельгия, в первом приближении, представляет собой утконос, для этого необходим заграничный паспорт, действительный в течение трех месяцев с момента завершения поездки со свободной страницей для визы. Альбатрос просветляет языковой Бахрейн. Портер применяет рельеф. Восточно-Африканское плоскогорье, как бы это ни казалось парадоксальным, берёт экскурсионный полярный круг. Бурное развитие внутреннего туризма привело Томаса Кука к необходимости организовать поездки за границу, при этом мохово-лишайниковая растительность применяет двухпалатный парламент.","Провоз кошек и собак прекрасно иллюстрирует гидроузел. Селитра поднимает глубокий утконос. Наводнение погранично. Большое Медвежье озеро начинает Карибский бассейн. Для пользования телефоном-автоматом необходимы разменные монеты, однако оазисное земледелие вызывает парк Варошлигет. Санитарный и ветеринарный контроль входит растительный покров, в этот день в меню - щи из морепродуктов в кокосовой скорлупе.",'Великобритания, несмотря на внешние воздействия, параллельна. Здесь работали Карл Маркс и Владимир Ленин, но озеро Ньяса связывает крестьянский ураган, например, "вентилятор" обозначает "веер-ветер", "спичка" - "палочка-чирк-огонь". Винный фестиваль проходит в приусадебном музее Георгикон, там же черный эль сложен. Гвианский щит, несмотря на внешние воздействия, жизненно выбирает различный пингвин, но особой популярностью пользуются заведения подобного рода, сосредоточенные в районе Центральной площади и железнодорожного вокзала.']},s=function(e){var t;return t=Math.floor(Math.random()*e.length),e[t]},t=function(){var t;return t=new e,t.country.split(",").map(function(e){return{name:e}})},a=function(t){var r,n;return r=new e,n=[],angular.forEach(t,function(e){return r.place.split(",").forEach(function(t){return n.push({name:t,countryId:e.objectId,countryName:e.name})})}),n},n=function(){var t;return t=new e,t.hotel.split(",").map(function(e){return{stars:+s(t.star.split(",")),name:e}})},o=function(){},i=function(t,r){var n,o,a,i,l,u,c,d,p,m,g;for(a=new e,g=[],u=l=0,p=t-1;p>=0?p>=l:l>=p;u=p>=0?++l:--l)o=s(r.countries),c=s(r.places),i=s(r.hotels),n=s(a.adjective.split(",")),m=n+" "+o.name,d=1e4*(Math.floor(15*Math.random())+5)-100,g.push({title:m,text:s(a.text),placeId:c.objectId,countryId:o.objectId,hotelId:i.objectId,duration:+s(a.duration.split(",")),price:d});return g},new(r=function(){this.countries=new t,this.hotels=new n,this.places=a,this.tours=i})})}.call(this),function(){angular.module("voyageVoyage").factory("NewFakerFactory",["_",function(e){var t,r,n,o,a,s,i;return t=function(){function e(){this.countryPlace={Argentina:["Buenos Aires","Aconcagua","Ushuaia","Mendoza"],Brazil:["Rio de Janeiro","Iguacu Falls","Amazon River"],France:["Paris","Bordeaux"],"Czech Republic":["Prague","Kutna Hora","Baden Baden"],Japan:["Tokyo","Sapporo"],Switzerland:["Montreux","Matterhorn","Geneva"],Germany:["Munich","Berlin","Neuschwanstein"],Russia:["St Petersburg","Kazan","Baikal Lake"]},this.duration="3,5,7,10,14,21",this.hotel="Four Seasons,Hyatt,Radisson,Kempinski,Marriot,Mandarin Oriental,Hilton",this.star="2,3,4,5",this.adjective="Gorgeous,Incredible,Brilliant,Stunning,Heartbreaking,Picturesque,Entertaining,Impressive,Remarkable",this.duration="3,5,7,10,14,21",this.hotel="Four Seasons,Hyatt,Radisson,Kempinski,Marriot,Mandarin Oriental,Hilton",this.star="2,3,4,5",this.text=["The LORD is my shepherd; I shall not want. He makes me lie down in green pastures. He leads me beside still waters. He restores my soul. He leads me in paths of righteousness for his name’s sake. Even though I walk through the valley of the shadow of death, I will fear no evil, for you are with me; your rod and your staff, they comfort me. You prepare a table before me in the presence of my enemies; you anoint my head with oil; my cup overflows. Surelyd goodness and mercye shall follow me all the days of my life, and I shall dwellf in the house of the LORD forever.","Sed ut perspiciatis, unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam eaque ipsa, quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt, explicabo. Nemo enim ipsam voluptatem, quia voluptas sit, aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos, qui ratione voluptatem sequi nesciunt, neque porro quisquam est, qui dolorem ipsum, quia dolor sit, amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt, ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit, qui in ea voluptate velit esse, quam nihil molestiae consequatur, vel illum, qui dolorem eum fugiat, quo voluptas nulla pariatur? At vero eos et accusamus et iusto odio dignissimos ducimus, qui blanditiis praesentium voluptatum deleniti atque corrupti, quos dolores et quas molestias excepturi sint, obcaecati cupiditate non provident, similique sunt in culpa, qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio, cumque nihil impedit, quo minus id, quod maxime placeat, facere possimus, omnis voluptas assumenda est, omnis dolor repellendus. Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet, ut et voluptates repudiandae sint et molestiae non recusandae. Itaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat."];

}return e}(),s=function(e){var t;return t=Math.floor(Math.random()*e.length),e[t]},r=function(){var r;return r=new t,e.keys(r.countryPlace)},a=function(r){var n,o;return n=new t,o=function(t,o){var a;return a=e.find(r,function(e){return e.name===o}),a&&e.each(n.countryPlace[o],function(e){return t.push({countryId:a.objectId,name:e})}),t},console.log(e.keys(n.countryPlace)),e.keys(n.countryPlace).reduce(o,[])},o=function(){var e;return e=new t,e.hotel.split(",").map(function(t){return{stars:+s(e.star.split(",")),name:t}})},i=function(r){var n,o,a,i,l;return o=new t,l=[],console.log(r.places[74]),console.log(new Date(r.places[74].createdAt)),console.log(new Date(2016,0,1)),console.log(new Date(r.places[74].createdAt)>new Date(2016,1,1)),a=r.places.filter(function(e){return new Date(e.createdAt)>new Date(2016,0,1)}),console.log(a),i=e.sample(a,a.length),n=function(t){return console.log(t),e.find(r.tour_images,function(e){return e.image_name===t.toLowerCase()})},e.each(i,function(e){var t,a,i,u;return a=s(r.hotels),t=s(o.adjective.split(",")),u=t+" "+e.name,i=1e4*(Math.floor(15*Math.random())+5)-100,l.push({title:u,text:s(o.text),placeId:e.objectId,countryId:e.countryId,hotelId:a.objectId,duration:+s(o.duration.split(",")),image:n(e.name).fileName,price:i})}),l},new(n=function(){this.countries=new r,this.hotels=new o,this.places=a,this.tours=i})}])}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};angular.module("voyageVoyage").factory("Entity",function(){var t;return t=function(){function t(t){this.name=t,this.hasChanges=e(this.hasChanges,this)}var r;return r=null,t.prototype.keepCopy=function(){return r=t.fromJSON(this)},t.fromJSON=function(e){var r;return r=new t,angular.extend(r,e)},t.prototype.commitChanges=function(){return r=null},t.prototype.rejectChanges=function(){var e,t;for(e in r)t=r[e],"function"!=typeof r[e]&&(this[e]=r[e]);return r=null},t.prototype.hasChanges=function(){return!this.isEqual(r)},t.prototype.isEmpty=function(){return _.chain(_.keys(this)).filter(function(e){return"function"!=typeof this[e]},this).reduce(function(e,t){return e&!this[t]},!0,this).value()},t.prototype.isEqual=function(e){return _.chain(_.keys(this)).filter(function(e){return"function"!=typeof this[e]},this).reduce(function(t,r){return t&this[r]===e[r]},!0,this).value()},t.fromArray=function(e){var r,n;return n=function(){var n,o,a;for(a=[],n=0,o=e.length;o>n;n++)r=e[n],a.push(t.fromJSON(r));return a}()},t}()})}.call(this),function(){angular.module("voyageVoyage").service("CRUDService",["PersistenceService","$log",function(e,t){return{add:function(t,r,n,o){return e.saveResource(t,r),n.push(r),o("browse")},remove:function(t,r,n){var o;return o=n[r],e.removeResource(t,o),n.splice(r,1)},update:function(t,r,n){return e.saveResource(t,r),n("browse")},cancelEdit:function(e,t){return e.rejectChanges(),t("browse")}}}])}.call(this),function(){angular.module("voyageVoyage").controller("CompanyController",["$scope","$http","$q","PersistenceService","TourRepository","PlaceRepository","NewFakerFactory","CountryRepository","HotelRepository","ImageUploadService","Parse","toastr","_",function(e,t,r,n,o,a,s,i,l,u,c,d,p){return e.newEmployee={name:"",company:null},n.loadResource("company").$promise.then(function(t){return e.companies=t}),e.persons=[{id:1,name:"Roman",age:40},{id:2,name:"Mike",age:33},{id:3,name:"Andrey",age:50},{id:4,name:"Sergey",age:44}],e.head="aaa",e.stars=3,e.image=null,e.parse=function(){return c.User.signUp("foo@bar.com","12345678").then(function(){return console.log("ok")})},e.upload=function(){var r;return r={image_name:"default",image:""},u.uploadImage(e.image,r).then(function(n){return console.log(n),r.fileName={__type:"File",name:n.data.name,url:n.data.url},r.image_name=e.description,delete r.image,t.post("https://api.parse.com/1/classes/tour_image",r).then(function(t){return e.description="",e.image=null,d.success("OK")})["catch"](function(e){return $log.error(e)})})},e["do"]=function(){var e;return e=s,r.all({countries:i.all().$promise,places:a.all().$promise,tour_images:t.get("https://api.parse.com/1/classes/tour_image"),hotels:l.all().$promise}).then(function(t){var r;return t.tour_images=t.tour_images.data.results,r=e.tours(t),r.forEach(function(e){return console.log(e.title),o.save(e)})})},e.add=function(){var r,n;return n={__type:"Pointer",className:"company",objectId:e.newEmployee.company},r={},angular.copy(e.newEmployee,r),r.company=n,t.post("https://api.parse.com/1/classes/employee",r).then(function(e){return console.log(e)})},e.get=function(t){return o.count().then(function(e){return console.log(e.data.count)}),o.getById(t).$promise.then(function(t){return e.theTour=t,d.success("Hello!")})}}])}.call(this),function(){angular.module("voyageVoyage").run(["NewTourNotification","$rootScope","$location","Parse",function(e,t,r,n){return e.init(),t.$on("$locationChangeStart",function(e,t,o){return/admin/.test(t)&!n.User.current()&&(e.preventDefault(),r.path("/login")),console.log(t),console.log(o)})}])}.call(this),function(){angular.module("voyageVoyage").config(["$urlRouterProvider","$locationProvider","$httpProvider","$stateProvider",function(e,t,r,n){return n.state("home",{url:"/",views:{nav:{templateUrl:"app/shared/nav.html",controller:"SignInController"},main:{templateUrl:"app/tours/index.html",controller:"ToursController"}}}).state("login",{url:"/login",views:{nav:{templateUrl:"app/shared/nav.html",controller:"SignInController"},main:{templateUrl:"app/users/login.html",controller:"SignInController"}}}).state("signup",{url:"/signup",views:{nav:{templateUrl:"app/shared/nav.html",controller:"SignInController"},main:{templateUrl:"app/users/signup.html",controller:"SignUpController"}}}).state("tour",{url:"/tour/:id",views:{nav:{templateUrl:"app/shared/nav.html",controller:"SignInController"},main:{templateUrl:"app/tours/show.html",controller:"TourController"}}}).state("admin",{url:"/admin",views:{nav:{templateUrl:"app/shared/nav.html",controller:"SignInController"},main:{templateUrl:"app/admin/tours/index.html",controller:"AdminToursController"}}}).state("places",{views:{nav:{templateUrl:"app/shared/nav.html",controller:"SignInController"},main:{templateUrl:"app/admin/places/index.html",controller:"PlacesController"}}}).state("countries",{views:{nav:{templateUrl:"app/shared/nav.html",controller:"SignInController"},main:{templateUrl:"app/admin/countries/index.html",controller:"CountriesController"}}}).state("hotels",{views:{nav:{templateUrl:"app/shared/nav.html",controller:"SignInController"},main:{templateUrl:"app/admin/hotels/index.html",controller:"HotelsController"}}}),e.otherwise("/"),t.html5Mode(!0),r.defaults.headers.common={"X-Parse-Application-Id":"sXYBJKAzNLajxXs0SqkpjDmPKSY8eES5c4xOH275","X-Parse-REST-API-Key":"kqikw9hrrEcVjXzXYBl3CpWstA9RodV2tOoKqFa0"}}])}.call(this),angular.module("voyageVoyage").run(["$templateCache",function(e){e.put("app/shared/nav.html",'<div class="temp-nav"><a ui-sref="home">Home</a> <span class="pull-right"><span ng-if="current()"><span class="glyphicon glyphicon-user"></span> <span ng-if="current()">{{ userName() }}</span> | <a href="#" ng-click="logOut()">Log out</a></span> <a ui-sref="login" href="#" ng-hide="current()">Login</a></span> <span><span ng-if="current()">| <a ui-sref="admin" href="#">tours</a> | <a ui-sref="places" href="#">places</a> | <a ui-sref="countries" href="#">countries</a> | <a ui-sref="hotels" href="#">hotels</a></span></span></div>'),e.put("app/experiments/index.html",'<div class="row top-row"><ng-include src="&#39;app/shared/logo.html&#39;"></ng-include></div><div class="row"><form class="form-inline"><div class="form-group"><input ng-model="description" type="text"></div><div class="form-group"><input ng-model="image" ngf-select="" type="file"></div><button class="btn btn-default" ng-click="upload()" type="submit">Save</button></form></div><div class="row"><img ngf-thumbnail="image || &#39;http://placehold.it/250x250&#39;"></div><div class="row"><button class="btn btn-default" ng-click="do()" type="submit">Faker</button></div><div class="row"><button class="btn btn-default" ng-click="parse()" type="submit">Parse</button></div><div class="row"><table class="table table-condensed"><thead><th>Name</th></thead><tbody><tr ng-repeat="company in companies"><td>{{ company.name }}</td></tr></tbody></table><form class="form-inline"><div class="form-group"><label>Name</label><input class="form-control" ng-model="newEmployee.name" type="text"></div><div class="form-group"><label>Company</label><select class="form-control" ng-model="newEmployee.company" ng-options="company.objectId as company.name for company in companies" required="true"></select></div><button class="btn btn-default" ng-click="add()" type="submit">Save</button></form><table class="table table-condensed"><thead><th>Name</th><th>Company</th></thead><tbody><tr ng-repeat="employee in employees"><td>{{ employee.name }}</td><td>{{ employee.company.name }}</td></tr></tbody></table><button class="btn btn-default" ng-click="get(&#39;ShL8mXtVwO&#39;)">Get sample</button><p>{{ theTour.text }}</p><table class="table table-condensed"><thead><th>Name</th></thead><tbody><tr ng-repeat="tour in tours"><td>{{ tour.title }}</td><td><button class="btn btn-default" ng-click="get(tour.objectId)">Get</button></td></tr></tbody></table></div>'),e.put("app/shared/error.messages.html",'<script id="vvErrorMessages" type="text/ng-template"><div class="error-message" ng-message="required"> Обязательное поле </div> <div class="error-message" ng-message="minlength"> Слишком короткое значение </div> <div class="error-message" ng-message="maxlength"> Слишком длинное значение </div> <div class="error-message" ng-message="min"> Не менее минимального значения </div> <div class="error-message" ng-message="max"> Не более максимального значения </div></script>'),e.put("app/shared/logo.html",'<div class="col-md-3"><span class="logo"><a href="/">VoyageVoyage</a></span></div>'),e.put("app/tours/index.html",'<div class="row top-row"><ng-include src="&#39;app/shared/logo.html&#39;"></ng-include><vv-tours-filter countries="countries" filter-changed="filterChanged()" places="places" selected-country="selectedCountry" selected-place="selectedPlace" selected-stars="selectedStars"></vv-tours-filter></div><div class="row jumbo" ng-hide="selectedCountry || selectedPlace || selectedStars"><uib-carousel interval="5000"><uib-slide ng-repeat="promo in promos"><a ui-sref="tour({id: promo.objectId})"><img height="200" ng-src="{{ promo.image.url }}" style="margin:auto"><div class="carousel-caption"><h4>{{ promo.title }}</h4></div></a></uib-slide></uib-carousel></div><vv-tour-teaser></vv-tour-teaser><div class="entry" ng-repeat="tour in tours | filter: countryFilter | filter: placeFilter | filter: starsFilter | limitTo: itemsOnPage: pageBeginIndex track by tour.objectId"><div class="row item user"><div class="col-md-3"><div class="image"><vv-tour-image-flipper><vv-tour-image image-url="{{ img }}" ng-repeat="img in tour.pics"></vv-tour-image><vv-tour-image image-url="{{ tour.image.url }}" ng-if="tour.image"></vv-tour-image></vv-tour-image-flipper></div></div><div class="col-md-9"><div class="row"><div class="title col-md-7 nopadding"><a ui-sref="tour({id: tour.objectId})">{{tour.title}}</a><vv-tour-link-filter id="{{ tour.countryId }}" text="{{ getCountryById(tour.countryId) }}" type="country"></vv-tour-link-filter><vv-tour-link-filter id="{{ tour.placeId }}" text="{{ getPlaceById(tour.placeId) }}" type="place"></vv-tour-link-filter><span class="label label-info">{{ tour.duration + \' ночей\' }}</span></div><span class="price pull-right col-md-2">{{tour.price | currency: "₽ " : 0}}</span></div><div class="row hotel nopadding"><span ng-hide="$index == state.editIndex">{{ getHotelById(tour.hotelId).name }} &nbsp;<vv-stars stars="{{ getHotelById(tour.hotelId).stars }}"></vv-stars></span></div><div class="row description">{{tour.text | cutWords:50}}<a ng-href="/#/tour/{{ tour.objectId }}">далее</a></div></div></div></div><div class="nopadding"><vv-pager current-page="currentPage" page-changed="setPage(page)" page-size="{{ itemsOnPage }}" total-items="{{ (tours | filter: countryFilter | filter: placeFilter | filter: starsFilter).length }}"></vv-pager></div>'),e.put("app/tours/show.html",'<div class="row top-row"><ng-include src="&#39;app/shared/logo.html&#39;"></ng-include></div><div class="row box"><div class="col-md-3"><vv-tour-image-flipper><vv-tour-image image-url="{{ img }}" ng-repeat="img in tour.pics"></vv-tour-image><vv-tour-image image-url="{{ tour.image.url }}" ng-if="tour.image"></vv-tour-image></vv-tour-image-flipper></div><div class="col-md-9"><h1>{{ tour.title }}</h1><h3>{{ hotel.stars + \'*\' }} {{ hotel.name }}</h3><span class="label label-primary">{{ country.name }}</span><span class="label label-success">{{ place.name }}</span><hr>{{tour.text}}</div></div>'),e.put("app/users/login.html",'<div class="row top-row"><ng-include src="&#39;app/shared/logo.html&#39;"></ng-include></div><div class="row"><div class="col-md-4 col-md-offset-4 box"><h2 class="text-center">Log in</h2><form name="form"><div class="form-group"><label for="username">Name or email</label><input class="form-control" id="username" ng-model="username" required="true" type="text"></div><div class="form-group"><label for="passw">Password</label><input class="form-control" id="passw" ng-model="password" required="true" type="password"></div><button class="btn btn-default" ng-click="login()" ng-disabled="form.$invalid" type="submit">Login</button></form></div></div>'),e.put("app/users/signup.html",'<ng-include src="&#39;app/shared/error.messages.html&#39;"></ng-include><div class="row top-row"><ng-include src="&#39;app/shared/logo.html&#39;"></ng-include></div><div class="row"><div class="col-md-4 col-md-offset-4 box"><h2 class="text-center">Sign up</h2><form name="form"><div class="form-group"><label for="username">Name or email</label><input class="form-control" name="username" ng-model="username" required="true" type="text"><div ng-if="form.username.$touched &amp;&amp; form.username.$error" ng-messages="form.username.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="form-group"><label for="passw">Password</label><input class="form-control" name="passw" ng-model="password" required="true" type="password"><div ng-if="form.passw.$touched &amp;&amp; form.passw.$error" ng-messages="form.passw.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="form-group"><label for="passwConf">Password confirmation</label><input class="form-control" name="passwConf" ng-model="passwordConfirmation" required="true" type="password"><div ng-if="form.passwConf.$touched &amp;&amp; form.passwConf.$error" ng-messages="form.passwConf.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><button class="btn btn-default" ng-click="signup()" ng-disabled="form.$invalid" type="submit">Register</button></form></div></div>'),e.put("app/admin/countries/index.html",'<div class="row top-row"><ng-include src="&#39;app/shared/logo.html&#39;"></ng-include></div><div class="row box"><div class="col-md-6"><div class="row action"><a class="btn btn-primary" href="" ng-click="setState(&#39;add&#39;)" ng-disabled="state.newButDisabled()" ng-show="state.newButShown()">Создать</a><input ng-model="state.country.name" ng-show="state.newFormShown()" placeholder="наименование" type="text"><button ng-show="state.newFormShown()" ngf-select="upload($file)">Set image</button><a class="btn btn-default pull-right" href="" ng-click="setState(&#39;browse&#39;)" ng-show="state.newFormShown()">Отмена</a><a class="btn btn-primary pull-right" href="" ng-click="add()" ng-show="state.newFormShown()">Сохранить</a></div><table class="table table-condensed"><tbody><tr ng-repeat="country in countries"><td><img height="20" ng-src="{{ country.image.url }}"></td><td><span ng-show="$index != state.editIndex">{{country.name}}</span><input ng-model="state.country.name" ng-show="$index == state.editIndex" placeholder="наименование" type="text"><button ng-show="$index == state.editIndex" ngf-select="upload($file)">Set image</button></td><td><a class="action pull-right" href="" ng-click="remove($index)" ng-show="state.editRemoveShown()">Удалить</a><a class="action pull-right" href="" ng-click="setState(&#39;edit&#39;, $index, country)" ng-show="state.editRemoveShown()">Редактировать</a><a class="btn btn-default pull-right" href="" ng-click="setState(&#39;browse&#39;)" ng-show="$index == state.editIndex">Отмена</a><a class="btn btn-primary pull-right" href="" ng-click="update()" ng-show="$index == state.editIndex">Сохранить</a></td></tr></tbody></table></div></div>'),e.put("app/admin/hotels/index.html",'<div class="row top-row"><ng-include src="&#39;app/shared/logo.html&#39;"></ng-include></div><div class="row box"><div class="col-md-6"><div class="row action"><a class="btn btn-primary" href="" ng-click="setState(&#39;add&#39;)" ng-disabled="state.newButDisabled()" ng-show="state.newButShown()">Создать</a></div><div class="row" ng-if="state.newFormShown()"><form name="form"><div class="col-md-3"><input name="name" ng-model="state.hotel.name" ng-show="state.newFormShown()" placeholder="наименование" required="true" type="text"></div><div class="col-md-3"><input max="5" min="1" name="stars" ng-model="state.hotel.stars" ng-show="state.newFormShown()" required="true" type="number"></div><div class="col-md-6"><a class="btn btn-default pull-right" href="" ng-click="setState(&#39;browse&#39;)" ng-show="state.newFormShown()">Отмена</a><a class="btn btn-primary pull-right" href="" ng-click="add()" ng-show="state.newFormShown()">Сохранить</a></div></form></div><table class="table table-condensed"><tbody><tr ng-repeat="hotel in hotels"><td><span ng-show="$index != state.editIndex">{{hotel.name}}</span><input ng-model="state.hotel.name" ng-show="$index == state.editIndex" placeholder="наименование" type="text"></td><td><span ng-show="$index != state.editIndex"></span><vv-stars ng-show="$index != state.editIndex" stars="{{hotel.stars}}"></vv-stars><input max="5" min="0" ng-model="state.hotel.stars" ng-show="$index == state.editIndex" type="number"></td><td><a class="action pull-right" href="" ng-click="remove($index)" ng-show="state.editRemoveShown()">Удалить</a><a class="action pull-right" href="" ng-click="setState(&#39;edit&#39;, $index, hotel)" ng-show="state.editRemoveShown()">Редактировать</a><a class="btn btn-default pull-right" href="" ng-click="setState(&#39;browse&#39;)" ng-show="$index == state.editIndex">Отмена</a><a class="btn btn-primary pull-right" href="" ng-click="update()" ng-show="$index == state.editIndex">Сохранить</a></td></tr></tbody></table></div></div>'),e.put("app/admin/places/index.html",'<div class="row top-row"><ng-include src="&#39;app/shared/logo.html&#39;"></ng-include></div><div class="row box"><div class="col-md-6"><div class="row action"><a class="btn btn-primary" href="" ng-click="setState(&#39;add&#39;)" ng-disabled="state.newButDisabled()" ng-show="state.newButShown()">Создать</a><input ng-model="state.place.name" ng-show="state.newFormShown()" placeholder="наименование" type="text"><select class="form-control" ng-model="state.place.countryId" ng-options="country.objectId as country.name for country in countries" ng-show="state.newFormShown()"></select><a class="btn btn-default pull-right" href="" ng-click="setState(&#39;browse&#39;)" ng-show="state.newFormShown()">Отмена</a><a class="btn btn-primary pull-right" href="" ng-click="add()" ng-show="state.newFormShown()">Сохранить</a></div><table class="table table-condensed"><tbody><tr ng-repeat="place in places"><td><span ng-show="$index != state.editIndex">{{place.name}}</span><input ng-model="state.place.name" ng-show="$index == state.editIndex" placeholder="наименование" type="text"></td><td><span ng-show="$index != state.editIndex">{{ getCountryById(place.countryId) }}</span><select class="form-control" ng-model="state.place.countryId" ng-options="country.objectId as country.name for country in countries" ng-show="$index == state.editIndex"></select></td><td><a class="action pull-right" href="" ng-click="remove($index)" ng-show="state.editRemoveShown()">Удалить</a><a class="action pull-right" href="" ng-click="setState(&#39;edit&#39;, $index, place)" ng-show="state.editRemoveShown()">Редактировать</a><a class="btn btn-default pull-right" href="" ng-click="setState(&#39;browse&#39;)" ng-show="$index == state.editIndex">Отмена</a><a class="btn btn-primary pull-right" href="" ng-click="update()" ng-show="$index == state.editIndex">Сохранить</a></td></tr></tbody></table></div></div>'),e.put("app/admin/tours/index.html",'<ng-include src="&#39;app/shared/error.messages.html&#39;"></ng-include><div class="row top-row"><ng-include src="&#39;app/shared/logo.html&#39;"></ng-include><div class="col-md-3 col-md-offset-6"><span ng-show="state.newButShown()"><a class="btn btn-default pull-right" href="" ng-click="setState(&#39;new&#39;)">Add new</a></span></div></div><ng-include src="&#39;app/admin/tours/new.tour.form.html&#39;"></ng-include><div class="entry" ng-repeat="tour in tours track by $index" ng-show="state.listShown()"><div class="row item" ng-if="$index == state.editIndex" ng-include="&#39;app/admin/tours/inline.edit.form.html&#39;"></div><div class="row item" ng-hide="$index == state.editIndex"><div class="col-md-3"><div class="img"><img alt="" height="130" ng-src="{{ tour.image.url || &#39;http://placehold.it/230x130?text=No+image&#39; }}" src="" width="230"></div></div><div class="col-md-9"><div class="row title"><span>{{tour.title}}</span></div><div class="row"><div class="title col-md-6 nopadding" ng-class="$index == state.editIndex ? &#39;col-md-3&#39; : &#39;col-md-6&#39;"><span class="label label-primary">{{ getCountryById(tour.countryId) }}</span><span class="label label-success">{{ getPlaceById(tour.placeId) }}</span><span class="label label-info">{{ tour.duration + \' ночей\' }}</span></div><div class="price pull-right col-md-2"><span>{{tour.price | currency: "₽ " : 0}}</span></div></div><div class="row hotel"><span>{{ getHotelById(tour.hotelId).name }} &nbsp;</span><vv-stars stars="{{ getHotelById(tour.hotelId).stars }}"></vv-stars></div><div class="row description"><span>{{tour.text}}</span></div><div class="row"><a class="action pull-right" href="" ng-click="setState(&#39;inlineEdit&#39;, tour, $index)">Edit</a><a class="action pull-right" href="" ng-click="remove(tour)">Remove</a></div></div></div></div><div class="row"><a class="btn btn-default" href="" ng-click="seedDb()" style="display: none">Seed DB</a></div>'),e.put("app/admin/tours/inline.edit.form.html",'<form name="inlineForm"><div class="col-md-3"><div class="img"><img alt="" height="130" ng-src="{{ tour.image.url }}" src="" width="230"><button ngf-select="upload($file)">Set image</button></div></div><div class="col-md-9"><div class="row"><div class="title col-md-9 nopadding"><input class="form-control" name="title" ng-maxlength="40" ng-minlength="3" ng-model="tour.title" placeholder="Title" required="true" type="text"><div ng-if="inlineForm.title.$touched &amp;&amp; inlineForm.title.$error" ng-messages="inlineForm.title.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="price pull-right col-md-3"><input class="form-control" min="1000" name="price" ng-model="tour.price" placeholder="Price" required="true" type="number"><div ng-if="inlineForm.price.$touched &amp;&amp; inlineForm.price.$error" ng-messages="inlineForm.price.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div></div><div class="row"><div class="title col-md-2 nopadding"><select class="form-control" id="" name="country" ng-model="tour.countryId" ng-options="country.objectId as country.name for country in countries" required="true"><option value="">--Выберите страну--</option></select><div ng-if="inlineForm.country.$touched &amp;&amp; inlineForm.country.$error" ng-messages="inlineForm.country.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="title col-md-2 nopadding"><select class="form-control" name="place" ng-model="tour.placeId" ng-options="place.objectId as place.name for place in places" required="true"><option value="">--Выберите место--</option></select><div ng-if="inlineForm.place.$touched &amp;&amp; inlineForm.place.$error" ng-messages="inlineForm.place.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="title col-md-2 nopadding"><input class="form-control" max="30" min="1" name="duration" ng-model="tour.duration" placeholder="Duration" required="true" type="number"><div ng-if="inlineForm.duration.$touched &amp;&amp; inlineForm.duration.$error" ng-messages="inlineForm.duration.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div></div><div class="row hotel"><select class="form-control" name="hotel" ng-model="tour.hotelId" ng-options="hotel.objectId as hotel.name for hotel in hotels" required="true"><option value="">Выберите отель</option></select><div ng-if="inlineForm.hotel.$touched &amp;&amp; inlineForm.hotel.$error" ng-messages="inlineForm.hotel.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="row description"><textarea class="form-control" name="text" ng-maxlength="5000" ng-minlength="10" ng-model="tour.text" placeholder="Description" required="true" rows="3"></textarea><div ng-if="inlineForm.text.$touched &amp;&amp; inlineForm.text.$error" ng-messages="inlineForm.text.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="row"><button class="btn btn-primary" ng-click="update()" ng-disabled="inlineForm.$invalid">Сохранить</button><button class="btn btn-default" ng-click="cancel()">Отменить</button></div></div></form>'),e.put("app/admin/tours/new.tour.form.html",'<div class="row box" ng-show="state.newFormShown()"><div class="col-md-8"><form class="form-horizontal" name="form"><div class="form-group"><label for="title">Заголовок</label><input class="form-control" name="title" ng-maxlength="40" ng-minlength="3" ng-model="tour.title" placeholder="Title" required="true" type="text"><div ng-if="form.title.$touched &amp;&amp; form.title.$error" ng-messages="form.title.$error"><div class="error-message" ng-message="minlength">Длина должна составлять не менее 3 символов</div><div class="error-message" ng-message="maxlength">Длина должна составлять не более 40 символов</div><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="form-group"><label for="text">Описание</label><textarea class="form-control" name="text" ng-maxlength="400" ng-minlength="10" ng-model="tour.text" placeholder="Description" required="true" rows="3"></textarea><div ng-if="form.text.$touched &amp;&amp; form.text.$error" ng-messages="form.text.$error"><div class="error-message" ng-message="minlength">Длина должна составлять не менее 10 символов</div><div class="error-message" ng-message="maxlength">Длина должна составлять не более 400 символов</div><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="form-group"><label for="country">Продолжительность</label><input class="form-control" max="30" min="1" name="duration" ng-model="tour.duration" placeholder="Duration" required="true" type="number"><div ng-if="form.duration.$touched &amp;&amp; form.duration.$error" ng-messages="form.duration.$error"><div class="error-message" ng-message="min">Не менее 1 дня</div><div class="error-message" ng-message="max">Не более 30 дней</div><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="form-group"><label for="country">Страна</label><select class="form-control" id="" name="country" ng-model="tour.countryId" ng-options="country.objectId as country.name for country in countries" required="true"><option value="">--Выберите страну--</option></select><div ng-if="form.country.$touched &amp;&amp; form.country.$error" ng-messages="form.country.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="form-group"><label for="country">Место</label><select class="form-control" id="" name="place" ng-model="tour.placeId" ng-options="place.objectId as place.name for place in places" required="true"><option value="">--Выберите место--</option></select><div ng-if="form.place.$touched &amp;&amp; form.place.$error" ng-messages="form.place.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="form-group"><label for="country">Отель</label><select class="form-control" id="" name="hotel" ng-model="tour.hotelId" ng-options="hotel.objectId as hotel.name for hotel in hotels" required="true"><option value="">--Выберите отель--</option></select><div ng-if="form.hotel.$touched &amp;&amp; form.hotel.$error" ng-messages="form.hotel.$error"><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div><div class="form-group"><div class="col-sm-3 nopadding"><label for="price">Цена</label><input class="form-control" min="1000" name="price" ng-model="tour.price" placeholder="Price" required="true" type="number"><div ng-if="form.price.$touched &amp;&amp; form.price.$error" ng-messages="form.price.$error"><div class="error-message" ng-message="min">Не менее 1000</div><div class="error-message" ng-messages-include="vvErrorMessages"></div></div></div></div><div class="form-group"><div class="col-sm-3 nopadding"><input ng-model="image" ngf-select="" type="file"><img ngf-thumbnail="image || &#39;http://placehold.it/250x250&#39;"></div></div><div class="form-group"><button class="btn btn-primary" ng-click="add()" ng-disabled="form.$invalid" type="submit">Создать</button><button class="btn btn-default" ng-click="cancel()">Отменить</button></div></form></div></div>'),e.put("app/shared/new_tour_teaser/tour.teaser.html",'<div class="row teaser" ng-show="tour"><div class="col-md-2"><span class="new">новый тур!</span></div><div class="col-md-8 tour"><a href="{{ tour.url }}">{{ tour.title }} за {{ tour.price }} руб</a></div><div class="col-md-2"><span class="new pull-right">новый тур!</span></div></div>'),e.put("app/shared/pager/pager.html",'<nav ng-class="{hidden: totalPages &lt; 2}"><ul class="pagination"><li ng-class="{disabled: currentPage == 1}" ng-if="pages.length &gt; 2"><a href="#" ng-click="setPage(1)"><span>&laquo;</span></a></li><li ng-class="{disabled: currentPage == 1}"><a href="#" ng-click="pageBackward()"><span>&larr; Prev</span></a></li><li ng-class="{active: page == currentPage}" ng-repeat="page in pages track by $index"><a href="#" ng-click="setPage(page)">{{ page }}</a></li><li ng-class="{disabled: currentPage == pages.length}"><a href="#" ng-click="pageForward()"><span>Next &rarr;</span></a></li><li ng-class="{disabled: currentPage == pages.length}" ng-if="pages.length &gt; 2"><a href="#" ng-click="setPage(pages.length)"><span>&raquo;</span></a></li></ul></nav>'),e.put("app/shared/star_rating/star.rating.html",'<div class="star-rating"><span class="glyphicon glyphicon-remove-sign" ng-click="reset()"></span><span class="glyphicon glyphicon-star" id="star" ng-class="$index &lt; stars ? &#39;glyphicon glyphicon-star&#39; : &#39;glyphicon glyphicon-star-empty&#39;" ng-click="setStar(i)" ng-repeat="i in times(5)"></span></div>'),e.put("app/shared/stars/stars.html",'<span class="glyphicon glyphicon-star" ng-repeat="i in times(stars)"></span>'),e.put("app/shared/tours_filter/tours.filter.html",'<div class="col-md-2"><vv-select display-field="name" empty-text="All countries" items="countries" ng-change="onFilterChanged()" ng-model="selectedCountry"></vv-select></div><div class="col-md-2"><vv-select display-field="name" empty-text="All places" items="placesFiltered" ng-change="onFilterChanged()" ng-model="selectedPlace"></vv-select></div><div class="col-md-2"><vv-star-rating ng-model="selectedStars"></vv-star-rating></div><a class="btn btn-danger" ng-click="reset()" ng-show="selectedStars || selectedPlace || selectedCountry">Сброс</a><div class="content" ng-transclude=""></div>'),
e.put("app/shared/vv_select/select.html",'<div class="wrapper-dropdown"><span>{{ current }}</span><ul class="dropdown"><li ng-show="emptyText"><a href="#" ng-click="reset()">{{ emptyText }}</a></li><li ng-repeat="item in items"><a href="#" ng-click="change(item, $index)">{{ item[displayField] }}</a></li></ul></div>')}]);